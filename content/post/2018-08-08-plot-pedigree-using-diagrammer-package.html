---
title: plotting pedigree using DiagrammeR and visNetwork packages
author: Sheng Luan
date: '2018-08-08'
slug: plot-pedigree-using-diagrammer-package
categories:
  - 可视化
tags:
  - R
header:
  caption: ''
  image: ''
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/vis/vis.css" rel="stylesheet" />
<script src="/rmarkdown-libs/vis/vis.min.js"></script>
<script src="/rmarkdown-libs/visNetwork-binding/visNetwork.js"></script>
<script src="/rmarkdown-libs/viz/viz.js"></script>
<link href="/rmarkdown-libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
<script src="/rmarkdown-libs/grViz-binding/grViz.js"></script>


<p><a href="https://github.com/rich-iannone/DiagrammeR">DiagrammeR</a>包提供了一个可以直接读取pedigree数据，画图的功能。这个包的问题是，没有一个使用指南，自己摸索起来很麻烦。</p>
<p>从实际测试结果来看，<a href="http://datastorm-open.github.io/visNetwork/">visNetwork</a>包更加有用，有详细的使用指南，可以跟shiny结合，能够在网页上点击，这是我比较感兴趣的。</p>
<div id="diagrammerrvisnetwork" class="section level2">
<h2>1.加载DiagrammerR和visNetwork包</h2>
<pre class="r"><code>rm(list = ls())
require(DiagrammeR)
require(visNetwork)
require(data.table)
require(optiSel)
knitr::opts_knit$set(fig.height=12, fig.width=12)</code></pre>
</div>
<div class="section level2">
<h2>2.读取系谱数据</h2>
<pre class="r"><code>ped_1 &lt;-  fread(file=&quot;datasets/ped1.csv&quot;)
#设置Sire和Dam列中0为NA
ped_1[Sire==&quot;0&quot;,Sire:=NA]
ped_1[Dam==&quot;0&quot;,Dam:=NA]
#利用optisel包中的系谱处理函数，对系谱进行预处理，如果包括性别，列表头用Sex表示
#addNum=TRUE,生成一个数字化系谱，下边两个包DiagrammeR和visNetwork要求节点从1开始连续编码
ped_1_pre &lt;-  as.data.table(prePed(ped_1,addNum = TRUE))</code></pre>
</div>
<div class="section level2">
<h2>3.生成节点和边数据</h2>
<p>DiagrammeR和visNetwork包需要两种类型数据：节点数据以及edge数据。后者表示节点的走向。</p>
<p>节点数据：id需要连续从1开始编号，label表示该节点的名称。预留一个sex字段，可以据此字段设置雌雄个体不同的形状、颜色等信息。</p>
<pre class="r"><code>node_1 &lt;- data.table(id=ped_1_pre$numIndiv,label=ped_1_pre$Indiv,sex=ped_1_pre$Sex)
edge_1_sire &lt;- ped_1_pre[,c(&quot;numIndiv&quot;,&quot;numSire&quot;)]
edge_1_dam &lt;- ped_1_pre[,c(&quot;numIndiv&quot;,&quot;numDam&quot;)]
setnames(edge_1_sire,c(&quot;numIndiv&quot;,&quot;numSire&quot;),c(&quot;from&quot;,&quot;to&quot;))
setnames(edge_1_dam,c(&quot;numIndiv&quot;,&quot;numDam&quot;),c(&quot;from&quot;,&quot;to&quot;))
edge_1 &lt;- rbind(edge_1_sire,edge_1_dam)
#edge_1中数据来自optiSel包prePed函数生成的数字系谱，其中默认缺失的个体编号为0，需要处理为NA
edge_1[to==0,to:=NA]
#排序
edge_1[order(from)] </code></pre>
<pre><code>##      from to
##   1:    1 NA
##   2:    1 NA
##   3:    2 NA
##   4:    2 NA
##   5:    3 NA
##  ---        
## 116:   58 56
## 117:   59 54
## 118:   59 55
## 119:   60 59
## 120:   60 58</code></pre>
<p>以下4-6主要是针对DiagrammeR包的操作。</p>
</div>
<div class="section level2">
<h2>4.生成空的图形</h2>
<pre class="r"><code>i_graph_1 &lt;-  create_graph()
i_graph_1 %&gt;% is_graph_empty()</code></pre>
<pre><code>## [1] TRUE</code></pre>
</div>
<div class="section level2">
<h2>5.增加节点数据</h2>
<pre class="r"><code>i_graph_1 &lt;- i_graph_1 %&gt;% add_nodes_from_table(table = node_1,label_col = label)</code></pre>
</div>
<div class="section level2">
<h2>6.增加边数据</h2>
<pre class="r"><code>i_graph_1 &lt;- i_graph_1 %&gt;% add_edges_from_table(table = edge_1,from_col = from,to_col = to,from_to_map = id_external)</code></pre>
</div>
<div class="section level2">
<h2>6. 绘图</h2>
<p>支持两种图形输出引擎：</p>
<p>第一种采用的是visNetwork。</p>
<pre class="r"><code>i_graph_1 %&gt;% render_graph(output = &quot;visNetwork&quot;)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"group":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"id_external":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"]},"edges":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"from":[30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58],"label":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":1}}},"physics":{"stabilization":{"enabled":true,"onlyDynamicEdges":false,"fit":true}},"layout":{"improvedLayout":true}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
<p>第二种graphviz，是默认的输出引擎。</p>
<pre class="r"><code>i_graph_1 %&gt;% render_graph(output = &quot;graph&quot;)</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"G500A475\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"2\" [label = \"G500A300\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"3\" [label = \"G500A511\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"4\" [label = \"G500A482\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"5\" [label = \"G500A664\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"6\" [label = \"G500A848\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"7\" [label = \"G500A938\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"8\" [label = \"G500C583\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"9\" [label = \"G500A990\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"10\" [label = \"G500C591\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"11\" [label = \"G500A256\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"12\" [label = \"G500A060\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"13\" [label = \"G500C317\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"14\" [label = \"G500C561\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"15\" [label = \"G500C612\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"16\" [label = \"G500C355\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"17\" [label = \"G500A004\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"18\" [label = \"G500A839\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"19\" [label = \"G500A563\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"20\" [label = \"G500A624\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"21\" [label = \"G500A167\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"22\" [label = \"G500A380\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"23\" [label = \"G500A808\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"24\" [label = \"G500C231\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"25\" [label = \"G500C185\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"26\" [label = \"G500A843\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"27\" [label = \"G500C423\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"28\" [label = \"G500C450\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"29\" [label = \"G500C032\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"30\" [label = \"G600B339\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"31\" [label = \"G600C802\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"32\" [label = \"G600C929\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"33\" [label = \"G600D971\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"34\" [label = \"G600E539\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"35\" [label = \"G600E852\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"36\" [label = \"G600F266\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"37\" [label = \"G600H419\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"38\" [label = \"G600H604\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"39\" [label = \"G600I438\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"40\" [label = \"G600I975\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"41\" [label = \"G600J134\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"42\" [label = \"G600J576\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"43\" [label = \"G600J858\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"44\" [label = \"G600K462\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"45\" [label = \"G600A417\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"46\" [label = \"G700A411\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"47\" [label = \"G700A903\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"48\" [label = \"G700B434\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"49\" [label = \"G700C161\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"50\" [label = \"G700C808\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"51\" [label = \"G700D544\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"52\" [label = \"G700F588\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"53\" [label = \"G700G965\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"54\" [label = \"G800B620\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"55\" [label = \"G800B771\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"56\" [label = \"G800D697\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"57\" [label = \"G800L886\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"58\" [label = \"G900E185\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"59\" [label = \"G900B326\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"60\" [label = \"G010D804\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\"] \n  \"30\"->\"1\" \n  \"31\"->\"2\" \n  \"32\"->\"3\" \n  \"33\"->\"4\" \n  \"34\"->\"5\" \n  \"35\"->\"6\" \n  \"36\"->\"1\" \n  \"37\"->\"7\" \n  \"38\"->\"8\" \n  \"39\"->\"9\" \n  \"40\"->\"10\" \n  \"41\"->\"11\" \n  \"42\"->\"7\" \n  \"43\"->\"12\" \n  \"44\"->\"13\" \n  \"45\"->\"14\" \n  \"46\"->\"33\" \n  \"47\"->\"34\" \n  \"48\"->\"31\" \n  \"49\"->\"42\" \n  \"50\"->\"40\" \n  \"51\"->\"30\" \n  \"52\"->\"32\" \n  \"53\"->\"39\" \n  \"54\"->\"49\" \n  \"55\"->\"53\" \n  \"56\"->\"47\" \n  \"57\"->\"50\" \n  \"58\"->\"57\" \n  \"59\"->\"54\" \n  \"60\"->\"59\" \n  \"30\"->\"15\" \n  \"31\"->\"16\" \n  \"32\"->\"17\" \n  \"33\"->\"18\" \n  \"34\"->\"19\" \n  \"35\"->\"20\" \n  \"36\"->\"15\" \n  \"37\"->\"21\" \n  \"38\"->\"22\" \n  \"39\"->\"23\" \n  \"40\"->\"24\" \n  \"41\"->\"25\" \n  \"42\"->\"26\" \n  \"43\"->\"27\" \n  \"44\"->\"28\" \n  \"45\"->\"29\" \n  \"46\"->\"41\" \n  \"47\"->\"44\" \n  \"48\"->\"37\" \n  \"49\"->\"35\" \n  \"50\"->\"36\" \n  \"51\"->\"43\" \n  \"52\"->\"45\" \n  \"53\"->\"38\" \n  \"54\"->\"46\" \n  \"55\"->\"51\" \n  \"56\"->\"48\" \n  \"57\"->\"52\" \n  \"58\"->\"56\" \n  \"59\"->\"55\" \n  \"60\"->\"58\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>从上边两张图可以看出，生成的图形，并不符合我们的要求。理想的系谱树，应该是树状的。</p>
<p>因此尝试设定布局参数为tree。</p>
<pre class="r"><code>i_graph_1 %&gt;% render_graph(layout = &quot;tree&quot;,output = &quot;graph&quot;,width=1200,height=800)</code></pre>
<div id="htmlwidget-3" style="width:1200px;height:800px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"G500A475\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"20,1!\"] \n  \"2\" [label = \"G500A300\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"4.5,1!\"] \n  \"3\" [label = \"G500A511\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"6.5,1!\"] \n  \"4\" [label = \"G500A482\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"18,1!\"] \n  \"5\" [label = \"G500A664\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"2.5,1!\"] \n  \"6\" [label = \"G500A848\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"22,1!\"] \n  \"7\" [label = \"G500A938\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"11.5,1!\"] \n  \"8\" [label = \"G500C583\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"26,1!\"] \n  \"9\" [label = \"G500A990\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"28,1!\"] \n  \"10\" [label = \"G500C591\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"13,1!\"] \n  \"11\" [label = \"G500A256\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"15,1!\"] \n  \"12\" [label = \"G500A060\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"24,1!\"] \n  \"13\" [label = \"G500C317\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0.5,1!\"] \n  \"14\" [label = \"G500C561\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"8.5,1!\"] \n  \"15\" [label = \"G500C612\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"19,1!\"] \n  \"16\" [label = \"G500C355\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"3.5,1!\"] \n  \"17\" [label = \"G500A004\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"7.5,1!\"] \n  \"18\" [label = \"G500A839\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"17,1!\"] \n  \"19\" [label = \"G500A563\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1.5,1!\"] \n  \"20\" [label = \"G500A624\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"23,1!\"] \n  \"21\" [label = \"G500A167\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"5.5,1!\"] \n  \"22\" [label = \"G500A380\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"27,1!\"] \n  \"23\" [label = \"G500A808\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"29,1!\"] \n  \"24\" [label = \"G500C231\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"14,1!\"] \n  \"25\" [label = \"G500C185\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"16,1!\"] \n  \"26\" [label = \"G500A843\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"21,1!\"] \n  \"27\" [label = \"G500C423\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"25,1!\"] \n  \"28\" [label = \"G500C450\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-0.5,1!\"] \n  \"29\" [label = \"G500C032\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"9.5,1!\"] \n  \"30\" [label = \"G600B339\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"21,2!\"] \n  \"31\" [label = \"G600C802\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"4,2!\"] \n  \"32\" [label = \"G600C929\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"6,2!\"] \n  \"33\" [label = \"G600D971\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"19,2!\"] \n  \"34\" [label = \"G600E539\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"2,2!\"] \n  \"35\" [label = \"G600E852\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"23,2!\"] \n  \"36\" [label = \"G600F266\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"20,2!\"] \n  \"37\" [label = \"G600H419\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"8,2!\"] \n  \"38\" [label = \"G600H604\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"27,2!\"] \n  \"39\" [label = \"G600I438\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"29,2!\"] \n  \"40\" [label = \"G600I975\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"11,2!\"] \n  \"41\" [label = \"G600J134\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"12.5,2!\"] \n  \"42\" [label = \"G600J576\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"15.5,2!\"] \n  \"43\" [label = \"G600J858\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"25,2!\"] \n  \"44\" [label = \"G600K462\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,2!\"] \n  \"45\" [label = \"G600A417\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"10,2!\"] \n  \"46\" [label = \"G700A411\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"16.5,3!\"] \n  \"47\" [label = \"G700A903\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0.5,3!\"] \n  \"48\" [label = \"G700B434\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"4.5,3!\"] \n  \"49\" [label = \"G700C161\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"23,3!\"] \n  \"50\" [label = \"G700C808\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"20,3!\"] \n  \"51\" [label = \"G700D544\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"25,3!\"] \n  \"52\" [label = \"G700F588\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"8,3!\"] \n  \"53\" [label = \"G700G965\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"29,3!\"] \n  \"54\" [label = \"G800B620\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"19,4!\"] \n  \"55\" [label = \"G800B771\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"28,4!\"] \n  \"56\" [label = \"G800D697\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"2.5,4!\"] \n  \"57\" [label = \"G800L886\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"13,4!\"] \n  \"58\" [label = \"G900E185\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"9.5,5!\"] \n  \"59\" [label = \"G900B326\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"22,5!\"] \n  \"60\" [label = \"G010D804\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"14.5,6!\"] \n  \"30\"->\"1\" \n  \"31\"->\"2\" \n  \"32\"->\"3\" \n  \"33\"->\"4\" \n  \"34\"->\"5\" \n  \"35\"->\"6\" \n  \"36\"->\"1\" \n  \"37\"->\"7\" \n  \"38\"->\"8\" \n  \"39\"->\"9\" \n  \"40\"->\"10\" \n  \"41\"->\"11\" \n  \"42\"->\"7\" \n  \"43\"->\"12\" \n  \"44\"->\"13\" \n  \"45\"->\"14\" \n  \"46\"->\"33\" \n  \"47\"->\"34\" \n  \"48\"->\"31\" \n  \"49\"->\"42\" \n  \"50\"->\"40\" \n  \"51\"->\"30\" \n  \"52\"->\"32\" \n  \"53\"->\"39\" \n  \"54\"->\"49\" \n  \"55\"->\"53\" \n  \"56\"->\"47\" \n  \"57\"->\"50\" \n  \"58\"->\"57\" \n  \"59\"->\"54\" \n  \"60\"->\"59\" \n  \"30\"->\"15\" \n  \"31\"->\"16\" \n  \"32\"->\"17\" \n  \"33\"->\"18\" \n  \"34\"->\"19\" \n  \"35\"->\"20\" \n  \"36\"->\"15\" \n  \"37\"->\"21\" \n  \"38\"->\"22\" \n  \"39\"->\"23\" \n  \"40\"->\"24\" \n  \"41\"->\"25\" \n  \"42\"->\"26\" \n  \"43\"->\"27\" \n  \"44\"->\"28\" \n  \"45\"->\"29\" \n  \"46\"->\"41\" \n  \"47\"->\"44\" \n  \"48\"->\"37\" \n  \"49\"->\"35\" \n  \"50\"->\"36\" \n  \"51\"->\"43\" \n  \"52\"->\"45\" \n  \"53\"->\"38\" \n  \"54\"->\"46\" \n  \"55\"->\"51\" \n  \"56\"->\"48\" \n  \"57\"->\"52\" \n  \"58\"->\"56\" \n  \"59\"->\"55\" \n  \"60\"->\"58\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>但是也存在一个问题，没有找到如何控制输出树状图大小，以及世代间距离的方法。</p>
<p>DiagrammeR的文档还不是很完善。没有一个指南，使用这个包很麻烦。</p>
<p>补充：其实是有一个使用指南的，在<a href="https://rich-iannone.github.io/DiagrammeR/docs.html">这里</a>，描述的很详细。</p>
<p>因此尝试直接利用visNetwork包来作图。</p>
</div>
<div id="visnetwork" class="section level2">
<h2>7.直接利用visNetwork包来绘图</h2>
<p>visNetwork做出来的图，很炫。是动态的，可以用鼠标来拖动每个节点。</p>
<p>其中有几个参数很重要：</p>
<p>direction表示图形的绘制方向，DU表示从下到上。</p>
<p>sortMethod表示如何排序，directed表示按照from to的方式排序。</p>
<p>levelSeparation 表示不同层间的距离，这个需要手动尝试。如果不设置，图会很小。</p>
<pre class="r"><code>visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;)  %&gt;% visHierarchicalLayout(direction = &quot;DU&quot;,sortMethod = &quot;directed&quot;,levelSeparation = 250, nodeSpacing = 150)</code></pre>
<div id="htmlwidget-4" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"hierarchical":{"enabled":true,"levelSeparation":250,"nodeSpacing":150,"direction":"DU","sortMethod":"directed"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="visnetwork" class="section level2">
<h2>8.visNetwork进阶</h2>
<div class="section level3">
<h3>8.1 雄性和雌性个体设置不同的形状和颜色</h3>
<p>雄雌个体节点形状分别设置为square、dot；颜色分别设置为绿色和红色。</p>
<pre class="r"><code>node_1[sex==&quot;male&quot;,shape:=&quot;square&quot;]
node_1[sex==&quot;female&quot;,shape:=&quot;dot&quot;]
node_1[sex==&quot;male&quot;,color:=&quot;#42c58c&quot;]
node_1[sex==&quot;female&quot;,color:=&quot;#e1409b&quot;]</code></pre>
<p>第一种配色：</p>
<pre class="r"><code>visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;)  %&gt;% visHierarchicalLayout(direction = &quot;DU&quot;,sortMethod = &quot;directed&quot;,levelSeparation = 250, nodeSpacing = 150)</code></pre>
<div id="htmlwidget-5" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"],"shape":["square","square","square","square","square","square","square","square","square","square","square","square","square","square","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","dot","dot","dot","dot","square","square","dot","square","dot","dot","dot","dot","square","dot","square","square","dot","dot","square","square","dot","dot","square","dot","square","dot"],"color":["#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#e1409b","#42c58c","#42c58c","#42c58c","#42c58c","#42c58c","#e1409b","#e1409b","#e1409b","#e1409b","#42c58c","#42c58c","#e1409b","#42c58c","#e1409b","#e1409b","#e1409b","#e1409b","#42c58c","#e1409b","#42c58c","#42c58c","#e1409b","#e1409b","#42c58c","#42c58c","#e1409b","#e1409b","#42c58c","#e1409b","#42c58c","#e1409b"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"hierarchical":{"enabled":true,"levelSeparation":250,"nodeSpacing":150,"direction":"DU","sortMethod":"directed"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
<p>第二种配色：</p>
<pre class="r"><code>node_1[sex==&quot;male&quot;,color:=&quot;#119ecc&quot;]
node_1[sex==&quot;female&quot;,color:=&quot;#f4b131&quot;]
visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;)  %&gt;% visHierarchicalLayout(direction = &quot;DU&quot;,sortMethod = &quot;directed&quot;,levelSeparation = 250, nodeSpacing = 150)</code></pre>
<div id="htmlwidget-6" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-6">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"],"shape":["square","square","square","square","square","square","square","square","square","square","square","square","square","square","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","dot","dot","dot","dot","square","square","dot","square","dot","dot","dot","dot","square","dot","square","square","dot","dot","square","square","dot","dot","square","dot","square","dot"],"color":["#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#f4b131","#f4b131","#f4b131","#f4b131","#119ecc","#119ecc","#f4b131","#119ecc","#f4b131","#f4b131","#f4b131","#f4b131","#119ecc","#f4b131","#119ecc","#119ecc","#f4b131","#f4b131","#119ecc","#119ecc","#f4b131","#f4b131","#119ecc","#f4b131","#119ecc","#f4b131"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"hierarchical":{"enabled":true,"levelSeparation":250,"nodeSpacing":150,"direction":"DU","sortMethod":"directed"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
<p>第二种配色，不用树状：</p>
<pre class="r"><code>node_1[sex==&quot;male&quot;,color:=&quot;#119ecc&quot;]
node_1[sex==&quot;female&quot;,color:=&quot;#f4b131&quot;]
node_1[label==&quot;G010D804&quot;,color:=&quot;red&quot;]
visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;) %&gt;% visOptions(highlightNearest = list(enabled=TRUE,degree=2))</code></pre>
<div id="htmlwidget-7" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-7">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"],"shape":["square","square","square","square","square","square","square","square","square","square","square","square","square","square","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","dot","dot","dot","dot","square","square","dot","square","dot","dot","dot","dot","square","dot","square","square","dot","dot","square","square","dot","dot","square","dot","square","dot"],"color":["#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#f4b131","#119ecc","#119ecc","#119ecc","#119ecc","#119ecc","#f4b131","#f4b131","#f4b131","#f4b131","#119ecc","#119ecc","#f4b131","#119ecc","#f4b131","#f4b131","#f4b131","#f4b131","#119ecc","#f4b131","#119ecc","#119ecc","#f4b131","#f4b131","#119ecc","#119ecc","#f4b131","#f4b131","#119ecc","#f4b131","#119ecc","red"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":2,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null}},"evals":[],"jsHooks":[]}</script>
<p>第三种配色：</p>
<pre class="r"><code>node_1[sex==&quot;male&quot;,color:=&quot;green&quot;]
node_1[sex==&quot;female&quot;,color:=&quot;red&quot;]
visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;)  %&gt;% visHierarchicalLayout(direction = &quot;DU&quot;,sortMethod = &quot;directed&quot;,levelSeparation = 250, nodeSpacing = 150)</code></pre>
<div id="htmlwidget-8" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-8">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"],"shape":["square","square","square","square","square","square","square","square","square","square","square","square","square","square","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","dot","dot","dot","dot","square","square","dot","square","dot","dot","dot","dot","square","dot","square","square","dot","dot","square","square","dot","dot","square","dot","square","dot"],"color":["green","green","green","green","green","green","green","green","green","green","green","green","green","green","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","green","green","green","green","green","red","red","red","red","green","green","red","green","red","red","red","red","green","red","green","green","red","red","green","green","red","red","green","red","green","red"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"hierarchical":{"enabled":true,"levelSeparation":250,"nodeSpacing":150,"direction":"DU","sortMethod":"directed"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
<p>第四种配色：</p>
<pre class="r"><code>node_1[sex==&quot;male&quot;,color:=&quot;#0c8a7a&quot;]
node_1[sex==&quot;female&quot;,color:=&quot;#ff8d7a&quot;]
visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;)  %&gt;% visHierarchicalLayout(direction = &quot;DU&quot;,sortMethod = &quot;directed&quot;,levelSeparation = 250, nodeSpacing = 150)</code></pre>
<div id="htmlwidget-9" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-9">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"],"shape":["square","square","square","square","square","square","square","square","square","square","square","square","square","square","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","dot","dot","dot","dot","square","square","dot","square","dot","dot","dot","dot","square","dot","square","square","dot","dot","square","square","dot","dot","square","dot","square","dot"],"color":["#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#0c8a7a","#ff8d7a","#0c8a7a","#ff8d7a"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"hierarchical":{"enabled":true,"levelSeparation":250,"nodeSpacing":150,"direction":"DU","sortMethod":"directed"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3>8.2选择展示的节点</h3>
<pre class="r"><code>visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;)  %&gt;% visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %&gt;%visHierarchicalLayout(direction = &quot;DU&quot;,sortMethod = &quot;directed&quot;,levelSeparation = 250, nodeSpacing = 150)</code></pre>
<div id="htmlwidget-10" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-10">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"],"shape":["square","square","square","square","square","square","square","square","square","square","square","square","square","square","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","dot","dot","dot","dot","square","square","dot","square","dot","dot","dot","dot","square","dot","square","square","dot","dot","square","square","dot","dot","square","dot","square","dot"],"color":["#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#0c8a7a","#ff8d7a","#0c8a7a","#ff8d7a"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"hierarchical":{"enabled":true,"levelSeparation":250,"nodeSpacing":150,"direction":"DU","sortMethod":"directed"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3>8.3 选择展示符合特定条件的个体</h3>
<p>譬如雌性个体或者雄性个体</p>
<pre class="r"><code>visNetwork(node_1,edge_1) %&gt;%  visEdges(arrows = &quot;to&quot;)  %&gt;% visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE, selectedBy = &quot;sex&quot;) %&gt;% visHierarchicalLayout(direction = &quot;DU&quot;,sortMethod = &quot;directed&quot;,levelSeparation = 250, nodeSpacing = 150)</code></pre>
<div id="htmlwidget-11" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-11">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"label":["G500A475","G500A300","G500A511","G500A482","G500A664","G500A848","G500A938","G500C583","G500A990","G500C591","G500A256","G500A060","G500C317","G500C561","G500C612","G500C355","G500A004","G500A839","G500A563","G500A624","G500A167","G500A380","G500A808","G500C231","G500C185","G500A843","G500C423","G500C450","G500C032","G600B339","G600C802","G600C929","G600D971","G600E539","G600E852","G600F266","G600H419","G600H604","G600I438","G600I975","G600J134","G600J576","G600J858","G600K462","G600A417","G700A411","G700A903","G700B434","G700C161","G700C808","G700D544","G700F588","G700G965","G800B620","G800B771","G800D697","G800L886","G900E185","G900B326","G010D804"],"sex":["male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","female","female","female","female","male","male","female","male","female","female","female","female","male","female","male","male","female","female","male","male","female","female","male","female","male","female"],"shape":["square","square","square","square","square","square","square","square","square","square","square","square","square","square","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","dot","dot","dot","dot","square","square","dot","square","dot","dot","dot","dot","square","dot","square","square","dot","dot","square","square","dot","dot","square","dot","square","dot"],"color":["#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#0c8a7a","#ff8d7a","#ff8d7a","#ff8d7a","#ff8d7a","#0c8a7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#0c8a7a","#0c8a7a","#ff8d7a","#ff8d7a","#0c8a7a","#ff8d7a","#0c8a7a","#ff8d7a"]},"edges":{"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,2,3,4,5,6,1,7,8,9,10,11,7,12,13,14,33,34,31,42,40,30,32,39,49,53,47,50,57,54,59,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,15,16,17,18,19,20,15,21,22,23,24,25,26,27,28,29,41,44,37,35,36,43,45,38,46,51,48,52,56,55,58]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"hierarchical":{"enabled":true,"levelSeparation":250,"nodeSpacing":150,"direction":"DU","sortMethod":"directed"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","variable":"sex","main":"Select by sex","values":["female","male"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
